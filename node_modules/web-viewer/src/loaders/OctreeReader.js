/**
 * @author muwj 2017/01/25
 */

CLOUD.Loader.OctNode = function ( buffer, offset ) {

    var data_i = new Uint32Array( buffer, offset, 5 );
    this.cell_id = data_i[0];
    this.child_s = data_i[3];
    this.child_e = data_i[4];

    var data_f = new Float32Array( buffer, offset + 5 * 4, 6 );
    this.boundingBox = new THREE.Box3(
        new THREE.Vector3( data_f[0], data_f[1], data_f[2] ),
        new THREE.Vector3( data_f[3], data_f[4], data_f[5] ) );
};

CLOUD.Loader.OctreeReader = function ( buffer ) {

    var data_i = new Uint32Array( buffer, 0, 1 );
    this.count = data_i[0];
    this.data = new Array( this.count );

    for ( var i = 0; i < this.count; ++i )
    {
        this.data[i] = new CLOUD.Loader.OctNode( buffer, ( 1 + i * 11 ) * 4 );
    }
};

CLOUD.Loader.OctreeReader.prototype = {

    constructor: CLOUD.Loader.OctreeReader,

    getCount: function () {

        return this.count;
    },

    getNode: function ( idx ) {

        if ( idx >= 0 && idx < this.count ) {

            return this.data[idx];
        }
    }
};